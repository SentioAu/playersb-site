<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Player Card Embed | PlayersB</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Lightweight embed player card powered by PlayersB data." />
  <link rel="canonical" href="https://playersb.com/embed/player/" />
  <link rel="stylesheet" href="/styles/site.css" />
  <style>
    body { margin: 0; background: transparent; }
    .embed-card { background: var(--surface); border: 1px solid var(--border); border-radius: 16px; padding: 16px; }
    .embed-header { display: flex; justify-content: space-between; gap: 12px; align-items: baseline; }
    .embed-title { font-size: 18px; font-weight: 700; margin: 0; }
    .embed-meta { color: var(--muted); font-size: 13px; margin: 4px 0 0; }
    .embed-grid { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 12px; margin-top: 12px; }
    .embed-stat { background: var(--surface-2); border-radius: 12px; padding: 10px; border: 1px solid var(--border); }
    .embed-label { font-size: 12px; color: var(--muted-light); }
    .embed-value { font-size: 16px; font-weight: 700; }
    .embed-link { display: inline-flex; margin-top: 12px; font-size: 12px; color: var(--accent); text-decoration: none; }
  </style>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-D5798TYENM"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-D5798TYENM');
  </script>
</head>
<body>
  <h1 class="visually-hidden">Player card embed</h1>
  <div class="embed-card" id="embedCard">Loading...</div>

  <script>
    (function () {
      const params = new URLSearchParams(location.search);
      const id = params.get("id") || "haaland";

      fetch("/data/players.json")
        .then((res) => res.json())
        .then((data) => {
          const players = Array.isArray(data.players) ? data.players : [];
          const match = players.find((p) => String(p.id).toLowerCase() === id.toLowerCase()) || players[0];
          if (!match) {
            document.getElementById("embedCard").textContent = "Player not found.";
            return;
          }

          const minutes = match.minutes || 0;
          const g90 = minutes > 0 ? (match.goals / (minutes / 90)) : 0;
          const a90 = minutes > 0 ? (match.assists / (minutes / 90)) : 0;

          const html = [
            '<div class="embed-header">',
            '  <div>',
            '    <p class="embed-title">' + match.name + '</p>',
            '    <p class="embed-meta">' + (match.position || '') + ' · ' + (match.team || '') + '</p>',
            '  </div>',
            '</div>',
            '<div class="embed-grid">',
            '  <div class="embed-stat">',
            '    <div class="embed-label">Goals / 90</div>',
            '    <div class="embed-value">' + g90.toFixed(2) + '</div>',
            '  </div>',
            '  <div class="embed-stat">',
            '    <div class="embed-label">Assists / 90</div>',
            '    <div class="embed-value">' + a90.toFixed(2) + '</div>',
            '  </div>',
            '  <div class="embed-stat">',
            '    <div class="embed-label">Minutes</div>',
            '    <div class="embed-value">' + minutes + '</div>',
            '  </div>',
            '  <div class="embed-stat">',
            '    <div class="embed-label">Goals</div>',
            '    <div class="embed-value">' + (match.goals || 0) + '</div>',
            '  </div>',
            '</div>',
            '<a class="embed-link" href="https://playersb.com/players/' + match.id + '/" target="_blank" rel="noreferrer">View full profile →</a>',
          ].join('');

          document.getElementById("embedCard").innerHTML = html;
        })
        .catch(() => {
          document.getElementById("embedCard").textContent = "Unable to load player.";
        });
    })();
  </script>
</body>
</html>